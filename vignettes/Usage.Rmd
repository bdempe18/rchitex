---
title: "The Master Rchitext"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Usage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo = FALSE}
suppressPackageStartupMessages(library(rchitex))
suppressPackageStartupMessages(library(tidyverse))
```

RCHITEX provides an extensive set of options allowing users to generate and output nicely formatted text tables wiles simultaneously outputting the equivalent Latex code to a provided path. rchitex is intended to bridge the gap between statistical exploration in R and article writing.

## Regression output

At its most core functionality, `build` converts a list of regression models to elegantly formatted text output. If an output path is not provided and md (standing for markdown) is set to its default value of null, a simple text representation of the data is printed to the console. 

``` {r textTables}
state_df <- as_tibble(datasets::state.x77)
tbl_title <- 'State summary statistics'
rchitex::describe(state_df, title = tbl_title)

```
By default, describe will calculate the number of observations, mean, standard deviation, min, and max of the data. The summary functions applied can be altered and reordered by passing a named vector or list of functions to the `statistics` argument. The label of each function should be a string expressing how the function should be expressed in the table.

Note that `describe` supports user-defined functions as long as the function maps a vector of data to a single value, $f: \mathbb{R}^d \mapsto \mathbb{R}$.

``` {r}

stat_funcs <- c('Average' = mean, 'St.D.' = sd, 
                'random value' = function(v) sample(v, 1))
rchitex::describe(state_df, title = tbl_title, statistics = stat_funcs)

```

Futher aesthetical modifications are available. Users can adjust the level of precision by overriding the default value for `max_precision`. 

The whole table can be inverted by setting `flip` to True.

``` {r}
rchitex::describe(state_df[,2:5], title = tbl_title, statistics = stat_funcs, 
         max_precision = 0, flip = TRUE)
```
### Latex and HTML output
Rchitex is likewise capable of producing the code necessary to output tables in LaTeX and HTML formats. By specifying a `path`, Rchitex will write a .tex file to the inputted path while also outputting the text table to the standard consule. The text output can be supressed by setting `silent` to TRUE.

Rather than simultaneous output, rchitex can directly write LaTeX and HTML to the consule. This is particularly important if using a Markdown file (like this document). The `md` argument should either be set to 'latex' or 'html'. Note that you may need to set the chunk option `results` to 'asis'

``` {r, results = 'asis'}
rchitex::describe(state_df[,2:5], title = tbl_title, statistics = stat_funcs, 
         max_precision = 0, flip = TRUE, md = 'html')
```

``` {r, results = 'asis'}
data(swiss)
mod1 <- lm(data=swiss, Fertility ~ Agriculture + Education)
mod2 <- lm(data=swiss, Fertility ~ Agriculture + Education + Infant.Mortality + Catholic + Examination)

rchitex::build(mod1, mod2, md = 'html')
```
### Standard errors

Standard errors can be specified in a number of ways. In most cases, you may need to apply robust standard errors. The `rse` class converts a model's standard errors to robust standard errors similar to STATA's robust option (HC1). 

```{r robust, results = 'asis'}
mod_rse <- rse(mod1)
build(mod1, mod_rse, annotations = list('RSE' = c('NO', 'YES')), md='html')
```
